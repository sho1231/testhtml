<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>

<body>
  <script>
    function getRandomInt(max) {
  return Math.floor(Math.random() * max);
}
let a= "fb-messenger-checkbox";
let b= "fb-send-to-messenger";
    window.fbAsyncInit = function() {
      FB.init({
        appId            : '635145891914368',
        xfbml            : true,
        version          : 'v17.0'
      });
      FB.Event.subscribe('send_to_messenger', function(e) {
      // callback for events triggered by the plugin
        console.log("Abc",e);
        if(e.is_after_optin){
        console.log("asdad");
      }
      else{
        console.log("false");
      }
      });
      /*FB.Event.subscribe('messenger_checkbox', function(e) {
        console.log("messenger_checkbox event");
        console.log(e);
          
        if (e.event == 'rendered') {
          console.log("Plugin was rendered");
        } else if (e.event == 'checkbox') {
          var checkboxState = e.state;
          console.log("Checkbox state: " + checkboxState);
        } else if (e.event == 'not_you') {
          console.log("User clicked 'not you'");
        } else if (e.event == 'hidden') {
          console.log("Plugin was hidden");
        }});*/

      let abcs=document.getElementsByClassName(b);
      console.log(abcs[0]);
      let ref = getRandomInt(23);
      let user_ref=getRandomInt(23)
      // abcs[0].setAttribute("user_ref",user_ref);
      abcs[0].setAttribute("ref",ref);
      abcs[0].setAttribute("origin",window.location.href);
      function confirmOptIn() {
    // FB.CheckboxPlugin.confirm({
    //   'app_id':'635145891914368',
    //   'page_id':'198520160022071',
    //   'ref':ref,
    //   'user_ref':user_ref
    // });
}
      
    };
    function test(e){
      // e.preventDefault();
      console.log(e);
    }
  </script>
  <script async defer crossorigin="anonymous" src="https://connect.facebook.net/en_US/sdk/debug.js"></script>
  <h1>108189667530839</h1>
  <h2>asd</h2>
  <div class="fb-send-to-messenger"  
    page_id=108189667530839
    messenger_app_id=635145891914368
    skin="dark"
    size="standard"
    enforce_login="true"
    >
  </div>
  <input type="submit" id="su"/>
  <script>
    let button = document.getElementById("su");
    console.log(button);
    document.addEventListener('click',test);
  </script>
</body>

</html>
